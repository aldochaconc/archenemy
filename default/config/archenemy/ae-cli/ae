#!/usr/bin/env bash
#
# Archenemy Command Center
# Main CLI entry point - Bash compatible
set -euo pipefail

ARCHENEMY_VERSION="1.0.0"
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Colors (only in interactive terminals)
if [[ -t 1 ]]; then
  RED='\033[0;31m'
  CYAN='\033[0;36m'
  BOLD='\033[1m'
  RESET='\033[0m'
else
  RED='' CYAN='' BOLD='' RESET=''
fi

show_help() {
  cat <<EOF
${BOLD}Archenemy${RESET} v$ARCHENEMY_VERSION - Hyprland Configuration Manager

${BOLD}USAGE:${RESET}
  ae <command> [options]

${BOLD}COMMANDS:${RESET}
  ${CYAN}keys, k${RESET}       Show keybinding reference
  ${CYAN}edit, e${RESET}       Open configuration editor
  ${CYAN}hypr, h${RESET}       Hyprland control interface
  ${CYAN}info, i${RESET}       Show system information
  ${CYAN}ref, r${RESET}        Show quick reference
  ${CYAN}help${RESET}          Show this help
  ${CYAN}version, -v${RESET}   Show version

${BOLD}EXAMPLES:${RESET}
  ae keys              # Show all keybindings
  ae keys --layer super
  ae keys --search
  ae edit hyprland     # Edit main config
  ae hypr reload       # Reload Hyprland
  ae ref keys          # Quick keybinding reference

Run ${CYAN}ae <command> --help${RESET} for more info on each command.
EOF
}

main() {
  local subcommand="${1:-}"
  shift || true

  case "$subcommand" in
  keys | k)
    exec "$SCRIPT_DIR/ae-keys" "$@"
    ;;
  edit | e)
    exec "$SCRIPT_DIR/ae-edit" "$@"
    ;;
  hypr | h)
    exec "$SCRIPT_DIR/ae-hypr" "$@"
    ;;
  info | i)
    exec "$SCRIPT_DIR/ae-info" "$@"
    ;;
  ref | reference | r)
    exec "$SCRIPT_DIR/ae-ref" "$@"
    ;;
  version | -v | --version)
    echo "Archenemy v$ARCHENEMY_VERSION"
    ;;
  help | --help | -h | "")
    show_help
    ;;
  *)
    echo -e "${RED}Error:${RESET} Unknown command '$subcommand'"
    echo "Run ${CYAN}ae help${RESET} for usage"
    exit 1
    ;;
  esac
}

main "$@"
