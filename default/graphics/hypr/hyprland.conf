#
# Archenemy Hyprland Configuration
# Inspired by the official Hyprland example config.
#

monitor=,preferred,auto,1

env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = QT_QPA_PLATFORM,wayland
env = GTK_THEME,Adwaita-dark

input {
  kb_layout = us
  follow_mouse = 1
  scroll_method = 0
  touchpad {
    natural_scroll = true
    tap-and-drag = true
  }
}

general {
  gaps_in = 6
  gaps_out = 10
  border_size = 2
  layout = dwindle
  no_focus_fallback = false
  resize_on_border = true
}

decoration {
  rounding = 8
  blur {
    enabled = true
    size = 6
    passes = 2
  }
}

animations {
  enabled = true
}

dwindle {
  pseudotile = true
  preserve_split = true
}

gestures {
  workspace_swipe = true
  workspace_swipe_fingers = 3
}

$terminal = kitty
$browser = chromium
$fileManager = nautilus
$launcher = walker

exec-once = uwsm-app -- hypridle
exec-once = uwsm-app -- hyprsunset
exec-once = uwsm-app -- mako
exec-once = uwsm-app -- waybar
exec-once = uwsm-app -- fcitx5
exec-once = uwsm-app -- swayosd-server
exec-once = uwsm-app -- elephant
exec-once = uwsm-app -- walker --gapplication-service
exec-once = swaybg -i ~/.config/background -m fill
exec-once = systemctl --user import-environment $(env | cut -d'=' -f 1)
exec-once = dbus-update-activation-environment --systemd --all

bind = SUPER, RETURN, exec, uwsm-app -- $terminal
bind = SUPER, B, exec, uwsm-app -- $browser
bind = SUPER, F, exec, uwsm-app -- $fileManager
bind = SUPER, SPACE, exec, uwsm-app -- $launcher
bind = SUPER, Q, killactive,
bind = SUPER, E, exec, uwsm-app -- gnome-text-editor
bind = SUPER, V, togglefloating
bind = SUPER, X, fullscreen
bind = SUPER, T, togglesplit

# Screenshot helpers
bind = , PRINT, exec, bash -lc 'tmp=$(mktemp /tmp/shot-XXXX.png); grim "$tmp" && wl-copy < "$tmp" && notify-send "Screenshot copied"; rm "$tmp"'
bind = SHIFT, PRINT, exec, bash -lc 'grim -g "$(slurp)" - | wl-copy && notify-send "Selection copied to clipboard"'

# Workspaces 1-9
bind = SUPER, 1, workspace,1
bind = SUPER, 2, workspace,2
bind = SUPER, 3, workspace,3
bind = SUPER, 4, workspace,4
bind = SUPER, 5, workspace,5
bind = SUPER, 6, workspace,6
bind = SUPER, 7, workspace,7
bind = SUPER, 8, workspace,8
bind = SUPER, 9, workspace,9

bind = SUPER SHIFT, 1, movetoworkspace,1
bind = SUPER SHIFT, 2, movetoworkspace,2
bind = SUPER SHIFT, 3, movetoworkspace,3
bind = SUPER SHIFT, 4, movetoworkspace,4
bind = SUPER SHIFT, 5, movetoworkspace,5
bind = SUPER SHIFT, 6, movetoworkspace,6
bind = SUPER SHIFT, 7, movetoworkspace,7
bind = SUPER SHIFT, 8, movetoworkspace,8
bind = SUPER SHIFT, 9, movetoworkspace,9

# Movement
bind = SUPER, h, movefocus,l
bind = SUPER, l, movefocus,r
bind = SUPER, k, movefocus,u
bind = SUPER, j, movefocus,d

# Resize
bind = SUPER CTRL, h, resizeactive,-20 0
bind = SUPER CTRL, l, resizeactive,20 0
bind = SUPER CTRL, j, resizeactive,0 20
bind = SUPER CTRL, k, resizeactive,0 -20

# Toggle nightlight
bind = SUPER CTRL, N, exec, bash -lc 'current=$(hyprctl hyprsunset temperature 2>/dev/null | grep -oE "[0-9]+"); if [[ "$current" -le 4500 ]]; then hyprctl hyprsunset temperature 6000; notify-send "  Nightlight disabled"; else hyprctl hyprsunset temperature 4000; notify-send "  Nightlight enabled"; fi'

# Toggle idle lock
bind = SUPER CTRL, I, exec, bash -lc 'if pgrep -x hypridle >/dev/null; then pkill -x hypridle && notify-send "Idle lock disabled"; else setsid uwsm-app -- hypridle >/dev/null 2>&1 & notify-send "Idle lock enabled"; fi'

# Notifications
bind = SUPER, COMMA, exec, makoctl dismiss
bind = SUPER SHIFT, COMMA, exec, makoctl dismiss --all
bind = SUPER CTRL, COMMA, exec, bash -lc 'makoctl mode -t do-not-disturb && makoctl mode | grep -q "do-not-disturb" && notify-send "Notifications silenced" || notify-send "Notifications enabled"'

# Volume/brightness via swayosd
$osdclient = swayosd-client --monitor "$(hyprctl monitors -j | jq -r '.[] | select(.focused == true).name')"
bindel = ,XF86AudioRaiseVolume, exec, $osdclient --output-volume raise
bindel = ,XF86AudioLowerVolume, exec, $osdclient --output-volume lower
bindel = ,XF86AudioMute, exec, $osdclient --output-volume mute-toggle
bindel = ,XF86MonBrightnessUp, exec, $osdclient --brightness raise
bindel = ,XF86MonBrightnessDown, exec, $osdclient --brightness lower

# Send battery reminder
bind = SUPER CTRL, B, exec, bash -lc 'level=$(upower -i /org/freedesktop/UPower/devices/battery_BAT0 2>/dev/null | awk "/percentage/ {print \$2}"); notify-send "󰁹  Battery" "Charge: ${level:-unknown}"'

windowrulev2 = suppressevent maximize, class:.*
windowrulev2 = nofocus,class:^$,title:^$,xwayland:1,floating:1,fullscreen:0,pinned:0

misc {
  disable_hyprland_logo = true
  enable_swallow = true
}
