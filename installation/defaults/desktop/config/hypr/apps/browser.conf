#
# Browser Window Rules
# https://wiki.hyprland.org/Configuring/Window-Rules/
#
# Configuration for web browsers: Chromium, Chrome, Firefox, Brave, Edge, etc.
#

# ============================================================================
# BROWSER CLASSIFICATION
# ============================================================================
# Tag browsers by engine type for unified styling
#   - Tags allow grouped window rules
#   - Useful for applying consistent behavior across browser types

# Chromium-based browsers
#   - Matches: Chromium, Chrome, Brave, Edge, Vivaldi, etc.
#   - Pattern: Case-insensitive regex for various browser classes
windowrule = tag +chromium-based-browser, class:((google-)?[cC]hrom(e|ium)|[bB]rave-browser|Microsoft-edge|Vivaldi-stable|helium)

# Firefox-based browsers
#   - Matches: Firefox, Zen Browser, LibreWolf, Floorp, etc.
windowrule = tag +firefox-based-browser, class:([fF]irefox|zen|librewolf|floorp)

# ============================================================================
# CHROMIUM --APP MODE BUG FIX
# ============================================================================
# Chromium browsers launched with --app flag have a bug where they float by default
#   - This forces them to tile properly
#   - Affects: Web apps launched via browser --app="url"
#   - Without this: Gmail, WhatsApp Web, etc. appear floating and misaligned

windowrule = tile, tag:chromium-based-browser

# ============================================================================
# BROWSER OPACITY
# ============================================================================
# Subtle transparency for better desktop integration
#   - First value: Active window opacity
#   - Second value: Inactive window opacity
#   - Video sites get exception below (no transparency for media)

# Chromium browsers: Subtle transparency
windowrule = opacity 1 0.97, tag:chromium-based-browser

# Firefox browsers: Subtle transparency
windowrule = opacity 1 0.97, tag:firefox-based-browser

# ============================================================================
# VIDEO SITE EXCEPTIONS (No Transparency)
# ============================================================================
# Full opacity for video streaming sites to prevent:
#   - Washed out colors
#   - Reduced contrast
#   - Video quality perception issues
#
# Uses initialTitle matching (URL-based detection)
#   - initialTitle: Title when window first opened (often contains URL)
#   - Persists even if page title changes

# YouTube (any subdomain)
#   - Pattern: (?i) = case insensitive
#   - Matches: youtube.com, music.youtube.com, m.youtube.com, etc.
#   - Format: initialTitle contains "youtube.com_/" (URL structure)
windowrule = opacity 1.0 1.0, initialTitle:((?i)(?:[a-z0-9-]+\.)*youtube\.com_/)

# Zoom Web Client
#   - Pattern matches Zoom web app URLs
windowrule = opacity 1.0 1.0, initialTitle:(app\.zoom\.us_/wc/home)

# Additional video/streaming platforms (uncomment as needed)
# Netflix:
# windowrule = opacity 1.0 1.0, initialTitle:((?i)netflix\.com_/)

# Twitch:
# windowrule = opacity 1.0 1.0, initialTitle:((?i)twitch\.tv_/)

# Disney+:
# windowrule = opacity 1.0 1.0, initialTitle:((?i)disneyplus\.com_/)

# Prime Video:
# windowrule = opacity 1.0 1.0, initialTitle:((?i)primevideo\.com_/)

# Vimeo:
# windowrule = opacity 1.0 1.0, initialTitle:((?i)vimeo\.com_/)

# Hulu:
# windowrule = opacity 1.0 1.0, initialTitle:((?i)hulu\.com_/)

# ============================================================================
# WEB APP WINDOW RULES
# ============================================================================
# Special handling for Progressive Web Apps (PWAs) and --app mode browsers

# Gmail Web App
#   - Float and center for email-like experience
# windowrule = float, initialTitle:(mail\.google\.com_/)
# windowrule = size 1400 900, initialTitle:(mail\.google\.com_/)

# Google Calendar
#   - Specific sizing for calendar view
# windowrule = float, initialTitle:(calendar\.google\.com_/)
# windowrule = size 1200 800, initialTitle:(calendar\.google\.com_/)

# WhatsApp Web
#   - Chat-app style window
# windowrule = float, initialTitle:(web\.whatsapp\.com_/)
# windowrule = size 1000 700, initialTitle:(web\.whatsapp\.com_/)

# Google Meet / Zoom meetings
#   - No border for cleaner video calls
# windowrule = noborder, initialTitle:(meet\.google\.com_/)
# windowrule = noborder, initialTitle:(zoom\.us_/wc/)

# ============================================================================
# BROWSER POPUP WINDOWS
# ============================================================================
# Handle popup windows (downloads, authentication, extensions)

# Download manager popups (floating)
#   - Firefox download panel
# windowrulev2 = float, class:([fF]irefox), title:(Downloads)

# Browser extension popups (1Password, Bitwarden, etc.)
#   - Float and size appropriately
# windowrulev2 = float, class:(chromium-browser), title:(Extension:)
# windowrulev2 = size 400 600, class:(chromium-browser), title:(Extension:)

# Authentication popups (OAuth, etc.)
#   - Float and center
# windowrulev2 = float, title:(Sign in - Google Accounts)
# windowrulev2 = center, title:(Sign in - Google Accounts)

# ============================================================================
# PICTURE-IN-PICTURE (PiP)
# ============================================================================
# Floating video player window

# Firefox PiP
#   - Always float, pin, and keep on top
windowrulev2 = float, class:([fF]irefox), title:(Picture-in-Picture)
windowrulev2 = pin, class:([fF]irefox), title:(Picture-in-Picture)
windowrulev2 = size 25% 25%, class:([fF]irefox), title:(Picture-in-Picture)

# Chromium PiP
windowrulev2 = float, class:(chromium-browser), title:(Picture-in-Picture)
windowrulev2 = pin, class:(chromium-browser), title:(Picture-in-Picture)
windowrulev2 = size 25% 25%, class:(chromium-browser), title:(Picture-in-Picture)

# ============================================================================
# BROWSER DEV TOOLS
# ============================================================================
# Developer tools window behavior

# Firefox Developer Tools
#   - Allow floating for flexible positioning
# windowrulev2 = float, class:([fF]irefox), title:(Developer Tools)
# windowrulev2 = size 50% 50%, class:([fF]irefox), title:(Developer Tools)

# Chrome DevTools (when detached)
#   - Detached DevTools windows
# windowrulev2 = float, class:(chromium-browser), title:(DevTools -)
# windowrulev2 = size 50% 50%, class:(chromium-browser), title:(DevTools -)

# ============================================================================
# INCOGNITO/PRIVATE WINDOWS
# ============================================================================
# Visual distinction for private browsing windows

# Different border color for private windows (optional)
#   - Helps identify private vs normal windows at a glance
# windowrulev2 = bordercolor rgb(b48ead), class:(chromium-browser), title:(.*Incognito.*)
# windowrulev2 = bordercolor rgb(b48ead), class:([fF]irefox), title:(.*Private Browsing.*)

# ============================================================================
# SCREEN SHARING INDICATORS
# ============================================================================
# Handle screen sharing indicator windows

# Chromium screen sharing indicator
#   - Float and position at top center
# windowrulev2 = float, class:(chromium-browser), title:(.*is sharing.*)
# windowrulev2 = size 400 80, class:(chromium-browser), title:(.*is sharing.*)
# windowrulev2 = move 50% 0, class:(chromium-browser), title:(.*is sharing.*)

# ============================================================================
# IDLE INHIBIT (Prevent Sleep During Video)
# ============================================================================
# Prevent screen from sleeping when watching videos in browser

# Inhibit idle when browser is fullscreen
#   - Useful for watching fullscreen videos
windowrule = idleinhibit fullscreen, tag:chromium-based-browser
windowrule = idleinhibit fullscreen, tag:firefox-based-browser

# Alternative: Inhibit idle when browser is focused (more aggressive)
# windowrule = idleinhibit focus, tag:chromium-based-browser
# windowrule = idleinhibit focus, tag:firefox-based-browser

# ============================================================================
# BROWSER-SPECIFIC TWEAKS
# ============================================================================

# Brave Browser specific
#   - Brave Rewards popup
# windowrulev2 = float, class:(brave-browser), title:(Brave Rewards)
# windowrulev2 = size 400 600, class:(brave-browser), title:(Brave Rewards)

# Microsoft Edge specific
#   - Sidebar popups
# windowrulev2 = float, class:(microsoft-edge), title:(Edge Sidebar)

# Vivaldi specific
#   - Quick Commands popup
# windowrulev2 = float, class:(vivaldi-stable), title:(Quick Commands)

# ============================================================================
# HOW TO FIND YOUR BROWSER'S CLASS
# ============================================================================
# Method 1: Check all browser windows
#   hyprctl clients | grep -A 10 "class:"
#
# Method 2: Focus browser and check active window
#   hyprctl activewindow | grep "class:"
#
# Common browser classes:
#   - Chromium: chromium-browser, chromium
#   - Chrome: google-chrome, Google-chrome
#   - Firefox: firefox, Firefox
#   - Brave: brave-browser, Brave-browser
#   - Edge: microsoft-edge, Microsoft-edge
#   - Vivaldi: vivaldi-stable
#   - Opera: opera
#   - Zen: zen-browser
#   - LibreWolf: librewolf

# ============================================================================
# NOTES
# ============================================================================
# Tag-based rules (tag:browser-name) apply to all windows with that tag
# initialTitle matching is reliable for web apps as URLs are in initial title
# Regular title: matching can break when page titles change dynamically
# Use (?i) in regex patterns for case-insensitive matching

