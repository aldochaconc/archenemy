#
# VSCode / Cursor / Code Editors Window Rules
# https://wiki.hyprland.org/Configuring/Window-Rules/
#
# Configuration for Visual Studio Code, Cursor, VSCodium, and similar Electron-based editors.
#

# ============================================================================
# VSCODE / CURSOR OVERVIEW
# ============================================================================
# VSCode and its variants are Electron apps with specific window behaviors:
#   - Main editor window
#   - Extension popups and webviews
#   - Integrated terminal
#   - Settings UI
#   - Quick Open / Command Palette (internal, not separate windows)
#
# Common classes:
#   - VSCode: code, Code, code-oss
#   - Cursor: cursor, Cursor
#   - VSCodium: codium, VSCodium
#   - Code - Insiders: code-insiders

# ============================================================================
# MAIN EDITOR WINDOW
# ============================================================================
# Primary editing window - usually want this tiled

# VSCode
windowrule = opacity 0.98 0.95, class:(code|Code|code-oss|VSCode)

# Cursor (VSCode fork)
windowrule = opacity 0.98 0.95, class:(cursor|Cursor)

# VSCodium (open-source VSCode)
windowrule = opacity 0.98 0.95, class:(codium|VSCodium|code-oss)

# Code - Insiders (preview version)
windowrule = opacity 0.98 0.95, class:(code-insiders|code-url-handler)

# Alternative: No transparency for better code readability
# windowrule = opacity 1 1, class:(code|cursor|codium)

# ============================================================================
# WORKSPACE ASSIGNMENT (Optional)
# ============================================================================
# Assign editors to specific workspace for organization

# All code editors to workspace 2
# windowrule = workspace 2, class:(code|cursor|codium|code-insiders)

# Separate by editor
# windowrule = workspace 2, class:(code|code-oss)     # VSCode
# windowrule = workspace 3, class:(cursor)            # Cursor
# windowrule = workspace 4, class:(codium)            # VSCodium

# ============================================================================
# SETTINGS & PREFERENCES
# ============================================================================
# Settings UI windows

# VSCode Settings (when opened in separate window)
windowrulev2 = float, class:(code|cursor), title:(Settings|Preferences)
windowrulev2 = size 60% 70%, class:(code|cursor), title:(Settings|Preferences)
windowrulev2 = center, class:(code|cursor), title:(Settings|Preferences)

# ============================================================================
# EXTENSION POPUPS & WEBVIEWS
# ============================================================================
# Extensions can create popup windows or webview panels

# Extension host windows (some extensions create separate windows)
#   - Usually these are internal to VSCode, not separate OS windows
#   - If an extension does create a window, it uses same class as main window

# Webview panels (for preview, documentation, etc.)
#   - Also internal to VSCode, not separate windows
#   - Documented here for reference

# ============================================================================
# INTEGRATED TERMINAL
# ============================================================================
# Terminal within VSCode/Cursor
#   - Integrated terminal is part of main window, not separate
#   - No special window rules needed
#   - Terminal panels managed by VSCode itself

# Note: If you open external terminal from VSCode, it uses terminal's class

# ============================================================================
# WELCOME SCREEN
# ============================================================================
# First-run welcome or update notifications

windowrulev2 = float, class:(code|cursor), title:(Welcome|Get Started)
windowrulev2 = size 900 700, class:(code|cursor), title:(Welcome|Get Started)
windowrulev2 = center, class:(code|cursor), title:(Welcome|Get Started)

# ============================================================================
# DIFF EDITOR / MERGE CONFLICTS
# ============================================================================
# Side-by-side diff view or merge conflict resolution
#   - Part of main window, no special rules needed
#   - VSCode manages split view internally

# External diff tool (if configured)
#   - Would use that tool's window class
#   - Example: Meld, Beyond Compare, etc.

# ============================================================================
# REMOTE DEVELOPMENT
# ============================================================================
# VSCode Remote Development (SSH, Containers, WSL)
#   - Connects to remote servers
#   - Window behavior same as local development
#   - Title includes "[Remote: connection-name]"

# Optional: Different opacity for remote windows
# windowrulev2 = opacity 0.95 0.90, class:(code), title:.*\[Remote:.*\].*

# ============================================================================
# LIVE SHARE / COLLABORATION
# ============================================================================
# VSCode Live Share for real-time collaboration
#   - No separate windows
#   - Collaboration happens within main editor
#   - Network activity indicators shown in status bar

# ============================================================================
# DEBUGGING WINDOWS
# ============================================================================
# Debug console, breakpoints, watch expressions
#   - All part of main window as panels
#   - No separate OS windows
#   - VSCode manages layout internally

# ============================================================================
# VSCODE SERVER (code-server)
# ============================================================================
# Browser-based VSCode (runs in browser, not Electron)
#   - Uses browser window class
#   - See browser.conf for web app rules

# Optional: Browser rule for code-server
# windowrulev2 = opacity 1 1, initialTitle:(code-server)

# ============================================================================
# PERFORMANCE OPTIMIZATIONS
# ============================================================================
# VSCode is resource-intensive, especially with many extensions

# Disable blur for better performance (optional)
# windowrule = noblur, class:(code|cursor|codium)

# No shadows (slight performance gain)
# windowrule = noshadow, class:(code|cursor|codium)

# ============================================================================
# WAYLAND NATIVE MODE
# ============================================================================
# VSCode/Cursor Wayland support
#   - Requires flags: --enable-features=UseOzonePlatform,WaylandWindowDecorations
#   - Set --ozone-platform=wayland
#   - Usually configured in desktop file or launch script
#   - env ELECTRON_OZONE_PLATFORM_HINT=wayland (already set in envs.conf)

# Some distributions ship with these flags enabled by default
# Check your .desktop file: /usr/share/applications/code.desktop

# ============================================================================
# EXTENSIONS THAT CREATE WINDOWS
# ============================================================================
# Some extensions may create separate windows:
#   - Live Server (browser preview)
#   - REST Client (API responses)
#   - Preview extensions (markdown, SVG, etc.)
#
# These usually open in default browser or as webviews (internal)

# ============================================================================
# IDLE INHIBIT (Optional)
# ============================================================================
# Prevent sleep during long builds or debugging

# Inhibit idle when editor is focused (optional)
# windowrule = idleinhibit focus, class:(code|cursor|codium)

# More useful: Inhibit during specific tasks (hard to detect automatically)

# ============================================================================
# MULTIPLE WINDOWS
# ============================================================================
# VSCode supports multiple windows for different projects
#   - Each window is independent
#   - All use same window class
#   - Title includes project name/folder

# Optional: Organize by project
#   - Requires manual workspace assignment or scripting
#   - Example: Project A on workspace 2, Project B on workspace 3
# windowrulev2 = workspace 2, class:(code), title:(.*Project-A.*)
# windowrulev2 = workspace 3, class:(code), title:(.*Project-B.*)

# ============================================================================
# ZEN MODE
# ============================================================================
# VSCode Zen Mode (View → Appearance → Zen Mode)
#   - Hides sidebars, panels, tabs
#   - Enters VSCode's fullscreen
#   - May interact with Hyprland fullscreen

# Optional: Detect Zen Mode and apply Hyprland fullscreen
#   - Difficult to detect reliably
#   - VSCode manages its own fullscreen state

# ============================================================================
# CURSOR-SPECIFIC FEATURES
# ============================================================================
# Cursor is a VSCode fork with AI features
#   - Same window behavior as VSCode
#   - AI chat panel is internal to main window
#   - No separate window rules needed

# Optional: Different opacity for Cursor
# windowrule = opacity 1 1, class:(cursor|Cursor)

# ============================================================================
# VSCODIUM-SPECIFIC FEATURES
# ============================================================================
# VSCodium is VSCode without Microsoft telemetry
#   - Identical window behavior
#   - Same extensions compatibility
#   - Uses different class name

# ============================================================================
# WINDOW SWALLOWING (Optional)
# ============================================================================
# When opening GUI apps from integrated terminal
#   - Terminal is part of VSCode, not a separate window
#   - Swallow behavior doesn't apply
#   - GUI apps open alongside VSCode

# ============================================================================
# HOW TO IDENTIFY VSCODE WINDOWS
# ============================================================================
# Method 1: Check active window
#   hyprctl activewindow | grep -E "(class|title)"
#
# Method 2: List all editor windows
#   hyprctl clients | grep -i code
#   hyprctl clients | grep -i cursor
#
# Common classes:
#   - code, Code, code-oss, VSCode
#   - cursor, Cursor
#   - codium, VSCodium
#   - code-insiders
#
# Common title patterns:
#   - "[Project Name] - Visual Studio Code"
#   - "[File Name] - Project - Visual Studio Code"
#   - "[Remote: SSH] - Project - Visual Studio Code"

# ============================================================================
# TROUBLESHOOTING
# ============================================================================
# Problem: Blurry text or interface
#   Solution: Ensure Wayland native mode, check scale settings
#
# Problem: Integrated terminal is slow
#   Solution: Change terminal renderer in settings (canvas vs dom)
#
# Problem: Extensions don't show popups
#   Solution: Most extension UI is internal to VSCode, no window rules needed
#
# Problem: Editor is laggy
#   Solution: Disable transparency, blur, reduce extension count
#
# Problem: Can't drag split editors
#   Solution: VSCode handles splits internally, no Hyprland issue
#
# Problem: Wrong workspace on launch
#   Solution: Use workspace rule (uncomment workspace assignments above)

# ============================================================================
# NOTES
# ============================================================================
# VSCode/Cursor window management:
#   - Single window per workspace/project
#   - Panels and sidebars managed internally
#   - Extensions run in same process (no separate windows)
#
# Opacity recommendations:
#   - 0.98/0.95: Subtle transparency, modern look
#   - 1.0/1.0: No transparency, best for code readability
#
# Performance considerations:
#   - VSCode is Electron (Chromium + Node.js)
#   - Can be resource-intensive with many extensions
#   - Transparency adds GPU load
#   - Blur adds more GPU load
#
# Wayland vs XWayland:
#   - Native Wayland: Better input, performance
#   - XWayland: Fallback, some bugs with IME
#   - Prefer native Wayland with proper flags
#
# Multiple instances:
#   - Each VSCode window is independent
#   - Can have different projects in different workspaces
#   - Use title: matching for project-specific rules

